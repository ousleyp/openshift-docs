[id="virt-2-6-release-notes"]
= {RN_BookName}
include::modules/virt-document-attributes.adoc[]
include::modules/common-attributes.adoc[]
:context: virt-release-notes
toc::[]

== About Red Hat {VirtProductName}

Red Hat {VirtProductName} enables you to bring traditional virtual machines (VMs) into {product-title} where they run alongside containers, and are managed as native Kubernetes objects.

{VirtProductName} is represented by the image:Operator_Icon-OpenShift_Virtualization-5.png[{VirtProductName},40,40] logo.

You can use {VirtProductName} with either the xref:../networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.adoc#about-ovn-kubernetes[OVN-Kubernetes] or the xref:../networking/openshift_sdn/about-openshift-sdn.adoc#about-openshift-sdn[OpenShiftSDN] default Container Network Interface (CNI) network provider.

Learn more about xref:../virt/about-virt.adoc#about-virt[what you can do with {VirtProductName}].

include::modules/virt-supported-cluster-version.adoc[leveloffset=+2]

[id="virt-guest-os"]
=== Supported guest operating systems
{VirtProductName} guests can use the following operating systems:

* Red Hat Enterprise Linux 6, 7, and 8.
* Microsoft Windows Server 2012 R2, 2016, and 2019.
* Microsoft Windows 10.

Other operating system templates shipped with {VirtProductName} are not supported.

[id="virt-2-6-new"]
== New and changed features

//CNV-7544: Microsoft's Windows Server Virtualization Validation Program (SVVP) applies to RHCOS workers

//CNV-9723: VMs are now migrated when a node is drained
* Virtual machines that have the `LiveMigratable` condition set to `True` and the `spec.evictionStrategy` field set to `LiveMigrate` are now migrated when a node is drained in preparation for maintenance. You can xref:../virt/node_maintenance/virt-setting-node-maintenance.adoc#virt-setting-node-maintenance[set a node to maintenance mode in the CLI] by running the `oc adm drain` command. The `NodeMaintenance` custom resource definition is no longer supported.

//CNV-9521: VMs that use UEFI can now be booted by using secure boot


[id="virt-2-6-installation-new"]
=== Installation

//CNV-7294: The cluster admin can now influence the node placement of OpenShift Virtualization pods
// AND
//CNV-9340: The cluster admin can now influence the node placement of the HPP pods
* Cluster administrators can now xref:../virt/install/virt-specifying-nodes-for-virtualization-components.adoc#virt-specifying-nodes-for-virtualization-components[configure node placement rules] for {VirtProductName} components, including the xref:../virt/install/virt-specifying-nodes-for-virtualization-components.adoc#node-placement-hpp_virt-specifying-nodes-for-virtualization-components[hostpath provisioner].


[id="virt-2-6-networking-new"]
=== Networking

//CNV-9518: OpenShift Virtualization is now supported by Calico CNI


[id="virt-2-6-storage-new"]
=== Storage

//CNV-9454: On filesystem-based PVCs, CDI now accounts for FS overhead

//CNV-9455: Improvements to KubeVirt and CDI ensure that storage is allocated on the correct node

//CNV-9456: When importing VM disk images, you can now control which multus network is used
* You can now add select supported annotations in the `metadata.annotations` field of a `DataVolume` object.
** To control which network the Containerized Data Importer (CDI) uses when importing virtual machine disk images, edit the `metadata.annotations` field of the `DataVolume` object, adding one of the following annotations:
`k8s.v1.cni.cncf.io/networks: <network_name>`:: If you use this annotation, the transfer pods use both the default network from the cluster and the secondary Multus network.
`v1.multus-cni.io/default-network: <network_name>`:: If you use this annotation, the transfer pods use the Multus network by default.
** By default, Istio sidecar injection to transfer pods is disabled. You can override the default option by using the following annotation:
`sidecar.istio.io/inject: “true”`::  This option enables sidecar injection to the transfer pods.


[id="virt-2-6-web-new"]
=== Web console

//CNV-9312: The VM wizard has been completely redesigned, simplifying VM creation
* The virtual machine wizard has been redesigned to simplify the process of xref:../virt/virtual_machines/virt-create-vms.adoc#virt-create-vms[creating virtual machines] by using preconfigured xref:../virt/vm_templates/virt-creating-vm-template.adoc#virt-creating-vm-template[virtual machine templates].

//CNV-9305: Templates in UI now contain default flavor and workload profile


[id="virt-2-6-changes"]
== Notable technical changes

//CNV-9339: When deploying from the GUI, the CR for the HCO is now created during subscription
* The procedure for xref:../virt/install/installing-virt-web.adoc#installing-virt-web[installing {VirtProductName} in the web console] has been streamlined. You can now create the `HyperConverged` custom resource immediately after installing the {VirtProductName} Operator by clicking *Create HyperConverged*.

//CNV-9457: CDI configuration parameters have moved from the CDIConfig object to the CDI CR

//CNV-10153: BareMetalPlatform removed from HCO CR
* Previously, there was a `spec.BareMetalPlatform` field in the `HyperConverged` object. This field has been removed.

[id="virt-2-6-known-issues"]
== Known issues

//New known issues for 2.6 (WIP)

//CNV-9288: Blank block disks and VMware imported disk images are not preallocated even if requested

//BZ-1855182 (https://bugzilla.redhat.com/show_bug.cgi?id=1855182): [Storage] Clone could not be continued after virtctl stop the vm if the clone dv have been created for more than 3 minutes

//The issues below are from the 2.5 release. See items above for new known issues for 2.6.

* If your {product-title} cluster uses OVN-Kubernetes as the default Container Network Interface (CNI) provider, you cannot attach a Linux bridge or bonding to the default interface of a host because of a change in the host network topology of OVN-Kubernetes. As a workaround, you can use a secondary network interface connected to your host or switch to the OpenShift SDN default CNI provider. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1885605[*BZ#1885605*])

* Running virtual machines that cannot be live migrated might block an {product-title} cluster upgrade. This includes virtual machines that use hostpath-provisioner storage or SR-IOV network interfaces. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1858777[*BZ#1858777*])
+
As a workaround, you can reconfigure the virtual machines so that they can be powered off during a cluster upgrade. In the `spec` section of the virtual machine configuration file:
+
. Remove the `evictionStrategy: LiveMigrate` field. See xref:../virt/live_migration/virt-configuring-vmi-eviction-strategy.adoc#virt-configuring-vmi-eviction-strategy[Configuring virtual machine eviction strategy] for more information on how to configure eviction strategy.
. Set the `runStrategy` field to `Always`.

* Live migration fails when nodes have different CPU models. Even in cases where nodes have the same physical CPU model, differences introduced by microcode updates have the same effect. This is because the default settings trigger host CPU passthrough behavior, which is incompatible with live migration. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1760028[*BZ#1760028*])

** As a workaround, set the default CPU model in the `kubevirt-config` ConfigMap, as shown in the following example:
+
[NOTE]
====
You must make this change before starting the virtual machines that support live migration.
====
+
. Open the `kubevirt-config` ConfigMap for editing by running the following command:
+
[source,terminal]
----
$ oc edit configmap kubevirt-config -n openshift-cnv
----
+
. Edit the ConfigMap:
+
[source,yaml]
----
kind: ConfigMap
metadata:
  name: kubevirt-config
data:
  default-cpu-model: "<cpu-model>" <1>
----
<1> Replace `<cpu-model>` with the actual CPU model value. You can determine this value by running `oc describe node <node>` for all nodes and looking at the `cpu-model-<name>` labels. Select the CPU model that is present on all of your nodes.

* If you enter the wrong credentials for the RHV Manager while importing a RHV VM, the Manager might lock the admin user account because the `vm-import-operator` tries repeatedly to connect to the RHV API. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1887140[*BZ#1887140*])
+
To unlock the account, log in to the Manager and enter the following command:
+
[source,terminal]
----
$ ovirt-aaa-jdbc-tool user unlock admin
----
